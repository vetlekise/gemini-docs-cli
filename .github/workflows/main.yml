name: Generate AI Documentation

on:
  workflow_dispatch:

jobs:
  update-docs:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write

    steps:
      - name: Checkout Source Code
        uses: actions/checkout@v4

      # Her bruker du din egensnekrede Action!
      - name: Run Gemini Docs
        uses: vetle-dev/gemini-docs-cli@main
        with:
          api_key: ${{ secrets.GEMINI_API_KEY }}
          model: 'gemini-1.5-pro'

      # Denne fanger opp AI_GENERATED.md og lager en PR av det automatisk
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v6
        with:
          commit-message: "docs: update AI generated architecture docs"
          title: "ðŸ¤– Auto-Generated Architecture Docs"
          body: "Gemini has analyzed the recent code changes and updated the architecture documentation."
          branch: "docs/gemini-update"